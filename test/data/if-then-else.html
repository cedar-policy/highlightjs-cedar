<span class="hljs-keyword">permit</span> <span class="hljs-punctuation">(</span>
  <span class="hljs-variable">principal</span><span class="hljs-punctuation">,</span>
  <span class="hljs-variable">action</span> <span class="hljs-operator">==</span> <span class="hljs-title class_">NameSpace::Action</span>::<span class="hljs-string">&quot;readObjects&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-variable">resource</span> <span class="hljs-operator">in</span> <span class="hljs-title class_">NameSpace::Container</span>::<span class="hljs-string">&quot;container&quot;</span>
<span class="hljs-punctuation">)</span>
<span class="hljs-keyword">when</span> <span class="hljs-punctuation">{</span> <span class="hljs-variable">resource</span><span class="hljs-punctuation">.</span>tenant <span class="hljs-operator">==</span> <span class="hljs-variable">principal</span><span class="hljs-punctuation">.</span>custom<span class="hljs-punctuation">.</span>tenant_id <span class="hljs-punctuation">}</span>
<span class="hljs-keyword">when</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-keyword">if</span>
    <span class="hljs-variable">resource</span> <span class="hljs-operator">has</span> owner
  <span class="hljs-keyword">then</span>
    <span class="hljs-variable">resource</span><span class="hljs-punctuation">.</span>owner <span class="hljs-operator">==</span> <span class="hljs-variable">principal</span><span class="hljs-punctuation">.</span>custom<span class="hljs-punctuation">.</span>user_id
  <span class="hljs-keyword">else</span>
    <span class="hljs-literal">true</span>
<span class="hljs-punctuation">}</span><span class="hljs-punctuation">;</span>