<span class="hljs-comment">// poorly formed: This identifier is reserved and cannot be used: XX</span>
<span class="hljs-keyword">permit</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">principal</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">action</span><span class="hljs-punctuation">,</span> <span class="hljs-variable">resource</span><span class="hljs-punctuation">)</span>
<span class="hljs-keyword">when</span> <span class="hljs-punctuation">{</span> <span class="hljs-variable">resource</span><span class="hljs-punctuation">.</span>ip <span class="hljs-operator">==</span> <span class="hljs-built_in">ip</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;127.0.0.1&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">}</span>
<span class="hljs-keyword">when</span> <span class="hljs-punctuation">{</span> <span class="hljs-variable">resource</span><span class="hljs-punctuation">.</span>decimal <span class="hljs-operator">==</span> <span class="hljs-built_in">decimal</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;0.1234&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">}</span>
<span class="hljs-keyword">when</span> <span class="hljs-punctuation">{</span> <span class="hljs-variable">resource</span><span class="hljs-punctuation">.</span><span class="hljs-keyword">if</span><span class="hljs-punctuation">.</span><span class="hljs-operator">in</span><span class="hljs-punctuation">.</span><span class="hljs-operator">has</span><span class="hljs-punctuation">.</span><span class="hljs-keyword">then</span><span class="hljs-punctuation">.</span><span class="hljs-keyword">else</span><span class="hljs-punctuation">.</span><span class="hljs-operator">like</span><span class="hljs-punctuation">.</span><span class="hljs-operator">is</span><span class="hljs-punctuation">.</span><span class="hljs-literal">true</span><span class="hljs-punctuation">.</span><span class="hljs-literal">false</span> <span class="hljs-punctuation">}</span>
<span class="hljs-keyword">when</span> <span class="hljs-punctuation">{</span> <span class="hljs-variable">resource</span><span class="hljs-punctuation">.</span>principal<span class="hljs-punctuation">.</span>resource<span class="hljs-punctuation">.</span>action<span class="hljs-punctuation">.</span>context <span class="hljs-punctuation">}</span>
<span class="hljs-keyword">when</span> <span class="hljs-punctuation">{</span> <span class="hljs-variable">resource</span><span class="hljs-punctuation">.</span>permit<span class="hljs-punctuation">.</span>forbid<span class="hljs-punctuation">.</span>when<span class="hljs-punctuation">.</span>unless <span class="hljs-punctuation">}</span><span class="hljs-punctuation">;</span>